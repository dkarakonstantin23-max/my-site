<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö–∞–±–∏–Ω–µ—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Caveat:wght@600&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  background: linear-gradient(180deg, #0b0b0b, #111);
  color: #eee;
  font-family: 'Montserrat', sans-serif;
  min-height: 100vh;
}

/* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.container {
  max-width: 1100px;
  margin: auto;
  padding: 40px 20px;
}

/* –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
h1 {
  font-family: 'Caveat', cursive;
  font-size: 44px;
  margin-bottom: 10px;
}

.subtitle {
  opacity: 0.6;
  margin-bottom: 30px;
}

/* –ø–∞–Ω–µ–ª—å —Å–≤–µ—Ä—Ö—É */
.top {
  display: flex;
  gap: 15px;
  margin-bottom: 30px;
}

input {
  flex: 1;
  padding: 14px;
  background: #161616;
  border: 1px solid #2a2a2a;
  color: #fff;
  outline: none;
  border-radius: 8px;
}

button {
  padding: 14px 22px;
  background: #f5c400;
  border: none;
  font-weight: 600;
  cursor: pointer;
  border-radius: 8px;
  transition: 0.3s;
}

button:hover {
  background: #ffd83d;
  transform: translateY(-2px);
}

/* –∫–∞—Ä—Ç–æ—á–∫–∏ */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
}

/* –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞—è–≤–∫–∏ */
.card {
  background: #141414;
  border: 1px solid #222;
  border-radius: 14px;
  padding: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.4);
  opacity: 0;
  transform: translateY(20px);
  animation: up 0.6s ease forwards;
}

@keyframes up {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.card h3 {
  margin: 0 0 10px;
  color: #f5c400;
}

.card span {
  display: block;
  opacity: 0.7;
  margin: 4px 0;
  font-size: 14px;
}

/* —Å—Ç–∞—Ç—É—Å */
.status {
  margin-top: 10px;
  display: inline-block;
  padding: 6px 10px;
  border-radius: 20px;
  font-size: 13px;
  background: rgba(245,196,0,0.15);
  color: #f5c400;
}
</style>
</head>

<body>

<div class="container">

<h1>–ö–∞–±–∏–Ω–µ—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞</h1>
<div class="subtitle">–ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∞–Ω–∫–µ—Ç—ã –ª—é–¥–µ–π, –ø—Ä–∏—à–µ–¥—à–∏—Ö –ø–æ –≤–∞—à–µ–π —Å—Å—ã–ª–∫–µ</div>

<div class="top">
  <input id="ref" placeholder="–í–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä: daniel)">
  <button onclick="load()">–ü–æ–∫–∞–∑–∞—Ç—å</button>
</div>

<div class="grid" id="list"></div>

</div>

<script>
function load() {
  const ref = document.getElementById('ref').value.trim();
  const data = JSON.parse(localStorage.getItem('leads')) || [];
  const list = document.getElementById('list');
  list.innerHTML = '';

  let delay = 0;

  data.filter(l => l.ref === ref).forEach(l => {
    const card = document.createElement('div');
    card.className = 'card';
    card.style.animationDelay = delay + 's';
    delay += 0.1;

    card.innerHTML = `
      <h3>${l.name}</h3>
      <span>üìû ${l.phone}</span>
      <span>‚úâÔ∏è ${l.tg || '‚Äî'}</span>
      <span>üïí ${l.date}</span>
      <div class="status">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</div>
    `;

    list.appendChild(card);
  });
}
</script>

</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  const supabase = supabase.createClient(
    "–í–ê–®_SUPABASE_URL",
    "–í–ê–®_SUPABASE_ANON_KEY"
  );

  async function load() {
    const refCode = document.getElementById("ref").value.trim();

    const { data, error } = await supabase
      .from("leads")
      .select("*")
      .eq("ref", refCode)
      .order('created_at', { ascending: false });

    const list = document.getElementById("list");
    list.innerHTML = "";

    if (error) {
      list.innerHTML = "<p>–û—à–∏–±–∫–∞: " + error.message + "</p>";
      return;
    }

    data.forEach(l => {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h3>${l.name}</h3>
        <span>üìû ${l.phone}</span>
        <span>‚úâÔ∏è ${l.telegram || "‚Äî"}</span>
        <span>üïí ${new Date(l.created_at).toLocaleString()}</span>
        <div class="status">–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞</div>
      `;
      list.appendChild(card);
    });
  }
</script>
